<style type="text/css">
.nav_form_tab{  background-color: #c7c7c7; color: white; font-size: 25px !important; width: 20px !important; min-width: auto !important; }
</style>

<div class="layui-tab-content">
    项目：{$app['name']}
    <hr >
    <div class="layui-tab layui-tab-card" style="height: auto;" lay-filter="api_nav">
        <ul class="layui-tab-title">      
            <li class="layui-this" v-for="(item,index) in api_item_array" v-cloak>{{item.name}}</li> 
            <li class="nav_form_tab">+</li> 
        </ul>
        
        <div class="layui-tab-content" style="padding: 10px;">            
            <div class="layui-tab-item layui-show">                    
                <div class="nav">
                    <div class="layui-btn-group">
                        <button class="layui-btn layui-btn-xs">添加接口</button><!-- 
                        <button class="layui-btn layui-btn-xs layui-btn-warm" >编辑栏目</button>
                        <button class="layui-btn layui-btn-xs layui-btn-danger" >删除栏目</button> -->
                    </div>
                    <span style='float:right;'>接口数量：<span class='right api_count'>{{this_api.length}}</span></span>
                </div>
                <table class="layui-table" lay-even lay-skin="nob">
                    <thead>
                        <tr>
                            <th>名称</th>                               
                            <th>排序</th>
                            <th class="handle">操作</th>
                        </tr>
                    </thead>
                    <tbody>   
                        <colgroup>
                            <col >
                            <col width="60">
                            <col width="120">
                        </colgroup>                 
                        <tr v-cloak v-for="(item,index) in this_api">
                            <td>{{item.name}}</td>
                            <td>{{item.sort}}</td>
                            <td class="handle">
                                <div class="layui-btn-group">
                                    <div class="layui-btn layui-btn-xs" @click="edit_api(index)">编辑</div>
                                    <div class="layui-btn layui-btn-xs layui-btn-danger" @click="del_api(index)">删除</div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>    
            <div class="layui-tab-item">
                <div class="layui-field-box">
                    <form class="layui-form layui-form-pane1 nav_form" action="">
                        <input type="hidden" name="nav_id" value="" placeholder="" autocomplete="off" class="layui-input">
                        <div class="layui-form-item">
                            <label class="layui-form-label">分类名称:</label>
                            <div class="layui-input-block">
                                <input type="text" name="name" lay-verify='required' value="<?php echo @$info['name'];?>" required placeholder="" autocomplete="off" class="layui-input">
                                <span class="remark"></span>
                            </div>
                        </div>                        
                       
                        <div class="layui-form-item">
                            <label class="layui-form-label">排序:</label>
                            <div class="layui-input-block">
                                <input type="text" name="sort" value="<?php echo (@$info['sort'] ? @$info['sort'] : 100);?>" required placeholder="" autocomplete="off" class="layui-input">
                                <span class="remark"></span>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="nav_form">提交</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>           
        </div>
    </div>   
    
    <div id="page"></div>
</div>

<script type="text/javascript">
var vue = new Vue({
    el:'.layui-tab-content',
    data:{
        api_item_array:JSON.parse('{:json_encode($api_item_array)}'),
        api_array:JSON.parse('{:json_encode($api_array)}'),
        this_api:new Array(),
    },
    methods:{
        init:function(){

        },
        init_api:function(index){
            var item = this.api_item_array[index];
            var api = new Array();
            for(var i in this.api_array){
                if(this.api_array[i].item_id == item.id){
                    api.push(this.api_array[i]);
                }
            }
            this.this_api = api;
            console.log(api);
        },
        edit_api:function(index){
            console.log(index);
        },
        del_api:function(index){
            console.log(index);
        },
    },
    mounted:function(){
        this.init_api(0);
    }
});
</script>